// Generated by CoffeeScript 1.4.0
var Node, plex;

Node = require('./node');

plex = {
  supportedAdaptors: 'socket.io',
  start: function(opts) {
    var edge, _i, _len, _ref;
    if (opts == null) {
      opts = {};
    }
    if (!(opts.listen || opts.connect)) {
      throw 'plex requires opts.connect and|or opts.listen';
    }
    _ref = ['connect', 'listen'];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      edge = _ref[_i];
      if (opts[edge]) {
        if (!opts[edge].adaptor) {
          throw "plex requires opts." + edge + ".adaptor";
        }
      }
    }
    if (opts.listen) {
      if (opts.connect) {
        opts.mode = 'proxy';
      } else {
        opts.mode = 'root';
      }
    }
    if (opts.connect && !opts.mode) {
      opts.mode = 'leaf';
    }
    return (new Node).start(opts);
  }
};

module.exports = plex;
